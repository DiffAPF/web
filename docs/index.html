<!doctype html>
<html lang="en" class="h-100">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Christopher Mitcheltree">
    <title>Differentiable All-pole Filters for Time-varying Audio Systems</title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
          integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <meta name="theme-color" content="#563d7c">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.0/font/bootstrap-icons.css">
</head>

<body>
<!-- Page Content -->
<div class="text-center">
    <div class="row">
        <div class="col-lg-12">
            <br>
            <h1 class="mt-5 mb-3">Differentiable All-pole Filters for Time-varying Audio Systems</h1>
            <p class="lead">
                <a href="https://yoyololicon.github.io/" target=”_blank”>Chin-Yun Yu</a> <sup>1</sup>,
                <a href="https://christhetr.ee/" target=”_blank”>Christopher Mitcheltree</a> <sup>1</sup>,
                <a href="https://www.linkedin.com/in/alistair-carson-a6178919a/" target=”_blank”>Alistair Carson</a> <sup>2</sup>,
<!--                <br>-->
                <a href="https://www.acoustics.ed.ac.uk/group-members/dr-stefan-bilbao/" target=”_blank”>Stefan Bilbao</a> <sup>2</sup>,
                <a href="https://www.eecs.qmul.ac.uk/~josh/" target=”_blank”>Joshua D. Reiss</a> <sup>1</sup>, and
                <a href="https://www.eecs.qmul.ac.uk/~gyorgyf/about.html" target=”_blank”>György Fazekas</a> <sup>1</sup>
            </p>

            <p class="lead">
                <sup>1</sup> Centre for Digital Music, Queen Mary University of London<br>
                <sup>2</sup> Acoustics and Audio Group, University of Edinburgh
            </p>

            <div>
                <a class="btn btn-outline-dark" href="docs/yu2024differentiable.pdf" target=”_blank” type="button">
                    <i class="bi bi-newspaper"></i> Paper</a>
<!--                <a class="btn btn-outline-dark" href="https://github.com/christhetree/all_pole_filters/" target=”_blank”-->
<!--                   type="button">-->
<!--                    <i class="bi bi-code-slash"></i> Code</a>-->
                <a class="btn btn-outline-dark" href="#plugins" type="button">
                    <i class="bi bi-box"></i> Plugins</a>
<!--                <a class="btn btn-outline-dark" href="https://youtu.be/nI_S7JTW_XI" target=”_blank” type="button">-->
<!--                    <i class="bi bi-camera-reels"></i> Video</a>-->
            </div>
        </div>
    </div>
</div>

<div class="container">
<!--    <div class="section mt-5 mb-5" id="video">-->
<!--        <div class="abstract">-->
<!--            <div class="iframe-container">-->
<!--                <iframe class="responsive-iframe"-->
<!--                    src="https://www.youtube.com/embed/nI_S7JTW_XI">-->
<!--                </iframe>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->

    <div class="section mt-5 mb-5">
        <div class="abstract">
            <h2>Abstract</h2>
            <hr>
            <p>
                Infinite impulse response filters are an essential building block of many time-varying audio systems, such as audio effects and synthesisers.
                However, their recursive structure impedes end-to-end training of these systems using automatic differentiation.
                Although non-recursive filter approximations like frequency sampling and frame-based processing have been proposed and widely used in previous works, they are approximations and cannot accurately reflect the gradient of the original system.
                We alleviate this difficulty by re-expressing a time-varying all-pole filter to backpropagate the gradients through itself, so the filter implementation is not bound to the technical limitations of automatic differentiation frameworks.
                This implementation can be employed within any audio system containing filters with poles for efficient gradient evaluation.
                We demonstrate its training efficiency and expressive capabilities for modelling real-world dynamic audio systems on a phaser, time-varying subtractive synthesiser, and feed-forward compressor.
                We make our code available and provide the trained audio effect and synth models in a VST plugin.
            </p>
            <br>
            <img class="img-fluid" src="img/filter_diagram.svg">
            <br>
            <br>
            <p class="text-center">Figure 1: <em>The forward (left) and backpropagation (right) flow chart of a third-order time-varying all-pole filter.</em></p>
        </div>
    </div>

    <div class="section">
        <h2 class="">Listening Samples</h2>
        <hr>
        <div class="section mb-5">
                <p>
                    We provide listening examples for

                </p>
                <p>
                    As discussed in more detail in the paper, we found

                </p>
                <p>
                    This website is best viewed using a Chromium based browser or Firefox.
                </p>
        </div>

        <h3 class="">Phaser (<em>Electro-Harmonix Small Stone</em>)</h3>
        <hr>
        <div class="row mb-4">
            <div class="col-md-6 text-center">
                <img class="img-fluid" src="img/phaser_diagram.svg">
                <br>
                <br>
                <p>Figure 2: <em>Discrete-time phaser model considered in this work, where K = 4. APF represents a time-varying all-pass filter with difference equation and BQ is a biquad filter.</em></p>
            </div>
            <div class="col-md-6">
                <p>
                    Phaser paragraphs.
                </p>
            </div>
        </div>

        <table class="table table-sm text-center" style="vertical-align: middle;">
            <tr>
                <th>Effect</th>
                <th>Dry</th>
                <th><span class="target">Wet</span></th>
                <th><span class="tcn">Extracted LFO</span></th>
                <th><span class="lstm">LSTM-64</span></th>
                <th><span class="signaltrain">Baseline</span></th>
            </tr>

            <tr>
                <td class="passage">Melda Phaser <p class="params">Quasiperiodic LFO<br>Example 1</p>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/melda/melda_ph_3_dry.wav" type="audio/wav">
                        Your browser does not support the audio element.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/melda/melda_ph_quasi_lstm_3_wet.wav" type="audio/wav">
                        Your browser does not support the audio element.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/melda/melda_ph_quasi_lstm_3_wet_hat.wav" type="audio/wav">
                        Your browser does not support the audio element.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/melda/melda_ph_quasi_rand_3_wet_hat.wav" type="audio/wav">
                        Your browser does not support the audio element.
                    </audio>
                </td>
            </tr>
        </table>

        <div class="text-center">
        <p class="text-center">Samples were selected randomly from the test dataset. No normalization has been applied.<br>&nbsp;</p>
        </div>

        <h3 class="">Time-varying Subtractive Synthesizer (<em>Roland TB-303 Bass Line</em>)</h3>
        <hr>
        <div class="row mb-4">
            <div class="col-md-6 text-center">
                <img class="img-fluid" src="img/synth_diagram.svg">
                <br>
                <br>
                <p>Figure 3: <em>Diagram of the differentiable synth modelling process. Our time-domain filter component is shown in green.</em></p>
            </div>
            <div class="col-md-6">
                <p>
                    Synth paragraphs.
                </p>
            </div>
        </div>

        <table class="table table-sm text-center" style="vertical-align: middle;">
            <tr>
                <th>Example Number</th>
                <th>Filter Config.</th>
                <th>Inference Method</th>
                <th><span class="target">Target</span></th>
                <th><span class="ours">TD (Ours)</span></th>
                <th><span class="others">FS 128</span></th>
                <th><span class="others">FS 256</span></th>
                <th><span class="others">FS 512</span></th>
                <th><span class="others">FS 1024</span></th>
                <th><span class="others">FS 2048</span></th>
                <th><span class="others">FS 4096</span></th>
                <th><span class="others">LSTM 64</span></th>
            </tr>

            <tr>
                <td>1</td>
                <td>Coeff.</td>
                <td>TD</td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/target_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/coeff_td_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/coeff_fs_128_td_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/coeff_fs_256_td_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/coeff_fs_512_td_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/coeff_fs_1024_td_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/coeff_fs_2048_td_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/coeff_fs_4096_td_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>N/A</td>
            </tr>
            <tr>
                <td>1</td>
                <td>Coeff.</td>
                <td>FS</td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/target_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>N/A</td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/coeff_fs_128_fs_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/coeff_fs_256_fs_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/coeff_fs_512_fs_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/coeff_fs_1024_fs_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/coeff_fs_2048_fs_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/coeff_fs_4096_fs_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>N/A</td>
            </tr>
            <tr>
                <td>1</td>
                <td>Low-pass</td>
                <td>TD</td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/target_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/lp_td_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/lp_fs_128_td_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/lp_fs_256_td_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/lp_fs_512_td_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/lp_fs_1024_td_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/lp_fs_2048_td_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/lp_fs_4096_td_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>N/A</td>
            </tr>
            <tr>
                <td>1</td>
                <td>Low-pass</td>
                <td>FS</td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/target_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>N/A</td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/lp_fs_128_fs_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/lp_fs_256_fs_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/lp_fs_512_fs_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/lp_fs_1024_fs_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/lp_fs_2048_fs_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/lp_fs_4096_fs_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>N/A</td>
            </tr>
            <tr>
                <td>1</td>
                <td>RNN</td>
                <td>TD</td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/target_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
                <td>N/A</td>
                <td>N/A</td>
                <td>N/A</td>
                <td>N/A</td>
                <td>N/A</td>
                <td>N/A</td>
                <td>N/A</td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/synth/lstm_64_1.wav" type="audio/wav">
                        Unsupported browser.
                    </audio>
                </td>
            </tr>
        </table>

        <div class="text-center">
        <p class="text-center">Individual samples were selected randomly from the test dataset. No normalization has been applied.<br>&nbsp;</p>
        </div>

        <h3 class="">Feed-forward Compressor (<em>LA-2A Leveling Amplifier</em>)</h3>
        <hr>

        <div class="section mb-5">
            <p>
                Compressor paragraphs
            </p>
        </div>

        <table class="table table-sm text-center" style="vertical-align: middle;">
            <tr>
                <th>Effect</th>
                <th>Dry</th>
                <th><span class="target">Wet</span></th>
                <th><span class="tcn">Extracted LFO</span></th>
                <th><span class="lstm">LSTM-64</span></th>
                <th><span class="signaltrain">Baseline</span></th>
            </tr>

            <tr>
                <td class="passage">EGFx Phaser <p class="params">Example 1</p>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/egfx/7_egfx_dry.wav" type="audio/wav">
                        Your browser does not support the audio element.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/egfx/7_egfx_ph_wet.wav" type="audio/wav">
                        Your browser does not support the audio element.
                    </audio>
                </td>
                <td>
                    <img class="img-fluid" src="img/7_egfx_ph_lstm_lfo.svg">
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/egfx/7_egfx_ph_lstm_wet_hat.wav" type="audio/wav">
                        Your browser does not support the audio element.
                    </audio>
                </td>
                <td>
                    <audio controls="controls" class="player" preload="metadata">
                        <source src="audio/egfx/7_egfx_ph_rand_wet_hat.wav" type="audio/wav">
                        Your browser does not support the audio element.
                    </audio>
                </td>
            </tr>
        </table>

        <div class="text-center">
        <p class="text-center">Samples were generated randomly from the test dataset. No normalization has been applied.<br>&nbsp;</p>
        </div>
    </div>

    <div class="section" id="plugins">
        <h2 class="">Plugins</h2>
        <hr>
        <div class="row mb-4">
            <div class="col-md-6 text-center">
                <img class="img-fluid" src="img/neutone.png">
            </div>
            <div class="col-md-6">
                <p>
                    We make the trained effect models accessible using the
                    <a href="https://neutone.ai" target=”_blank”>Neutone</a> plugin and SDK.
                    This enables most users to experiment with the models via a real-time VST plugin in their preferred
                    digital audio workstation (DAW) on arbitrary input audio. Older and / or slower CPUs may struggle
                    to run the models in real time.
                </p>
                <h5>Instructions:</h5>
                <ol>
                    <li><a href="https://neutone.ai/plugin/" target=”_blank”>Download</a> and install the Neutone
                        plugin.
                    </li>
                    <li>Download a model file from the links below.</li>
                    <li>Open the plugin in your preferred digital audio workstation.</li>
                    <li>Click on "load your own" at the top of the Neutone plugin interface and select one of the
                        models you just downloaded.
                    </li>
<!--                    <li>-->
<!--                        Use the four custom knobs to control the model:-->
<!--                        <ul>-->
<!--                            <li>Knob A: LFO rate (0.1 to 5 Hz)</li>-->
<!--                            <li>Knob B: LFO depth (0.0 to 1.5)</li>-->
<!--                            <li>Knob C: LFO stereo phase offset (0 to 360 degrees)</li>-->
<!--                            <li>Knob D: Unused</li>-->
<!--                        </ul>-->
<!--                    </li>-->
                </ol>
<!--                <p>-->
<!--                For best results we recommend setting the input gain knob to -6 dB to avoid clipping, setting your-->
<!--                DAW's sample rate to the native sample rate of the models (44.1 kHz), and using a buffer size of 128-->
<!--                samples or more.-->
<!--                </p>-->
                <h5>Model Files:</h5>
                <ul>
<!--                    <li><a href="neutone/melda_phaser_quasiperiodic.nm" download="melda_phaser_quasiperiodic.nm">Melda Phaser LSTM-64</a> (trained on quasiperiodic LFO)</li>-->
<!--                    <li><a href="neutone/melda_flanger_quasiperiodic.nm" download="melda_flanger_quasiperiodic.nm">Melda Flanger LSTM-64</a> (trained on quasiperiodic LFO)</li>-->
<!--                    <li><a href="neutone/melda_phaser_irregular.nm" download="melda_phaser_irregular.nm">Melda Phaser LSTM-64</a> (trained on irregular LFO)</li>-->
<!--                    <li><a href="neutone/melda_flanger_irregular.nm" download="melda_flanger_irregular.nm">Melda Flanger LSTM-64</a> (trained on irregular LFO)</li>-->
<!--                    <li><a href="neutone/egfx_phaser.nm" download="egfx_phaser.nm">EGFx Phaser LSTM-64</a></li>-->
<!--                    <li><a href="neutone/egfx_flanger.nm" download="egfx_flanger.nm">EGFx Flanger LSTM-64</a> (was not modeled successfully)</li>-->
<!--                    <li><a href="neutone/egfx_chorus.nm" download="egfx_chorus.nm">EGFx Chorus LSTM-64</a> (was not modeled successfully)</li>-->
                </ul>
            </div>
        </div>
    </div>

<!--    <div class="section">-->
<!--        <h2>Citation</h2>-->
<!--        <hr>-->
<!--        <p>Accepted to the 26th International Conference on Digital Audio Effects (DAFx23), Copenhagen, Denmark, 4 - 7 September 2023.</p>-->
<!--        <div style="background-color: #e9ecef;">-->
<!--  <pre><code>-->
<!--  @inproceedings{mitcheltree2023modulation,-->
<!--      title={Modulation Extraction for LFO-driven Audio Effects},-->
<!--      author={Christopher Mitcheltree and Christian J. Steinmetz and Marco Comunità and Joshua D. Reiss},-->
<!--      booktitle={International Conference on Digital Audio Effects (DAFx)},-->
<!--      year={2023}-->
<!--  }-->
<!--  </code></pre>-->
<!--        </div>-->
<!--    </div>-->

    <hr>
    <footer>
        <p>Send feedback and questions to <a href="https://yoyololicon.github.io" target=”_blank”>Chin-Yun
            Yu</a> or <a href="https://christhetr.ee" target=”_blank”>Christopher
            Mitcheltree</a>.<br>Scroll to <a href="#">top</a>.</p>
        <p>&nbsp;</p>
    </footer>
</div>

<!-- Bootstrap core JavaScript -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
        integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
        crossorigin="anonymous"></script>
<script src="js/slider.js"></script>
</body>

</html>
